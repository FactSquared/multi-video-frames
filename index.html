<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>
        Play/view multiple video player streams in the same browser window by using iframes - joelpurra.com/projects/multi-video-frames/
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="./resources/style/main.css" />
</head>

<body>
    <header>
        <h1>
            Play/view multiple video player streams in the same browser window by
            using iframes
        </h1>
        <p>
            Actually, the code is generic enough to open any pages, not only video
            pages, in the frames. Knock yourself out.
        </p>
    </header>
    <footer class="container">
        <p>
            <a href="./">Clear/reset all frames/pages.</a>
            Coded by
            <a href="https://joelpurra.com/">Joel Purra</a>
            &copy; 2012. You should be at
            <a href="https://joelpurra.com/projects/multi-video-frames/">joelpurra.com/projects/multi-video-frames/</a>
            but have a look at
            <a href="https://github.com/joelpurra/multi-video-frames/">github.com/joelpurra/multi-video-frames/</a>
            too.
        </p>
    </footer>
    <section id="controls">
        <button id="addUrl" type="button">
            Add frame
        </button>
    </section>
    <section id="videos">
    </section>
    <script src="./resources/javascript/external/jquery-1.12.4.min.js"></script>
    <script>
    //<![CDATA[
    $.fn.extend({
        scrollToTop: function() {
            $('html, body').animate({
                scrollTop: Math.max(0, $(this).offset().top)
            });
        }
    });

    $(function() {
        function addUrlInput() {
            var $urlInput = $("<input />", {
                "type": "url",
                "placeholder": "Copy and paste URL here"
            }).data("random", getRandom()).appendTo($controls);

            return $urlInput;
        }

        function getRandom() {
            return Math.floor(Math.random() * 100000) + 100000;
        }

        function addVideoPanel($urlInput) {
            var $videoPanel = $("<iframe />").addClass("videoPanel").data("$urlInput", $urlInput).appendTo($videos);
            $urlInput.data("$videoPanel", $videoPanel).focus();

            setVideoSizes();

            return $videoPanel;
        }

        function updateVideoPanels() {
            var $videoPanels = $videos.find(".videoPanel"),
            videoPanelCount = $videoPanels.length,
            // TODO: make horizontal/vertical video panel count a setting
            videoPanelsHorizontalMax = 3,
            videoPanelsVerticalMax = 3,
            videoPanelsHorizontal = Math.min(Math.ceil(Math.sqrt(videoPanelCount)), videoPanelsHorizontalMax),
            videoPanelsVertical = videoPanelsHorizontal === 0 ? 0 : Math.min(Math.ceil(videoPanelCount / videoPanelsHorizontal), videoPanelsVerticalMax);
            // Clear all classes
            $controls.attr("class", "").addClass("urlInputs-" + videoPanelsHorizontal).scrollToTop();

            // Clear all classes
            $videos.attr("class", "").addClass("videoPanelsHorizontal-" + videoPanelsHorizontal).addClass("videoPanelsVertical-" + videoPanelsVertical);
        }

        function setVideoSizes() {
            updateVideoPanels();
        }

        var $window = $(window),
        $controls = $("#controls"),
        $addUrl = $("#addUrl"),
        $videos = $("#videos"),
        loaded = [];

        $controls.scrollToTop();

        updateVideoPanels();

        $addUrl.click(function(evt) {
            var $target = $(evt.target),
            $urlInput = addUrlInput(),
            $videoPanel = addVideoPanel($urlInput);
        });

        $window.on("change", function(evt) {
            function loadUrl() {
                $videoPanel.attr("src", url);
            }

            var $target = $(evt.target),
            random = $target.data("random"),
            url = $target.val(),
            $videoPanel = $target.data("$videoPanel");

            $videos.scrollToTop();

            loadUrl();
        });
    });
    //]]>
    </script>
    <!--#include virtual="/tracker/piwik.html"-->
</body>
</html>
